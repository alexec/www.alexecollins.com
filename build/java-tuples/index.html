<!doctype html> <html> <head> <meta charset=utf-8 /> <meta http-equiv=X-UA-Compatible content='IE=edge;chrome=1'/> <meta name=viewport content="width=device-width, initial-scale=1.0"> <meta name=google-site-verification content=459WLyNfyiKwT7T3IzdCjzIpNP-IVQSOb4tR8b2vQhI /> <title>Alex Collins - Java Tuples</title> <link href="/css/bootstrap.min.css" media=screen rel=stylesheet /> <style type="text/css">
.highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight {
  color: #faf6e4;
  background-color: #122b3b;
}
.highlight .gl {
  color: #dee5e7;
  background-color: #4e5d62;
}
.highlight .c, .highlight .cd, .highlight .cm, .highlight .c1, .highlight .cs {
  color: #6c8b9f;
  font-style: italic;
}
.highlight .cp {
  color: #b2fd6d;
  font-weight: bold;
  font-style: italic;
}
.highlight .err {
  color: #fefeec;
  background-color: #cc0000;
}
.highlight .gr {
  color: #fefeec;
  background-color: #cc0000;
}
.highlight .k, .highlight .kd, .highlight .kv {
  color: #f6dd62;
  font-weight: bold;
}
.highlight .o, .highlight .ow {
  color: #4df4ff;
}
.highlight .p, .highlight .pi {
  color: #4df4ff;
}
.highlight .gd {
  color: #cc0000;
}
.highlight .gi {
  color: #b2fd6d;
}
.highlight .ge {
  font-style: italic;
}
.highlight .gs {
  font-weight: bold;
}
.highlight .gt {
  color: #dee5e7;
  background-color: #4e5d62;
}
.highlight .kc {
  color: #f696db;
  font-weight: bold;
}
.highlight .kn {
  color: #ffb000;
  font-weight: bold;
}
.highlight .kp {
  color: #ffb000;
  font-weight: bold;
}
.highlight .kr {
  color: #ffb000;
  font-weight: bold;
}
.highlight .gh {
  color: #ffb000;
  font-weight: bold;
}
.highlight .gu {
  color: #ffb000;
  font-weight: bold;
}
.highlight .kt {
  color: #b2fd6d;
  font-weight: bold;
}
.highlight .no {
  color: #b2fd6d;
  font-weight: bold;
}
.highlight .nc {
  color: #b2fd6d;
  font-weight: bold;
}
.highlight .nd {
  color: #b2fd6d;
  font-weight: bold;
}
.highlight .nn {
  color: #b2fd6d;
  font-weight: bold;
}
.highlight .bp {
  color: #b2fd6d;
  font-weight: bold;
}
.highlight .ne {
  color: #b2fd6d;
  font-weight: bold;
}
.highlight .nl {
  color: #ffb000;
  font-weight: bold;
}
.highlight .nt {
  color: #ffb000;
  font-weight: bold;
}
.highlight .m, .highlight .mf, .highlight .mh, .highlight .mi, .highlight .il, .highlight .mo, .highlight .mb, .highlight .mx {
  color: #f696db;
  font-weight: bold;
}
.highlight .ld {
  color: #f696db;
  font-weight: bold;
}
.highlight .ss {
  color: #f696db;
  font-weight: bold;
}
.highlight .s, .highlight .sb, .highlight .sd, .highlight .s2, .highlight .sh, .highlight .sx, .highlight .sr, .highlight .s1 {
  color: #fff0a6;
  font-weight: bold;
}
.highlight .se {
  color: #4df4ff;
  font-weight: bold;
}
.highlight .sc {
  color: #4df4ff;
  font-weight: bold;
}
.highlight .si {
  color: #4df4ff;
  font-weight: bold;
}
.highlight .nb {
  font-weight: bold;
}
.highlight .ni {
  color: #999999;
  font-weight: bold;
}
.highlight .w {
  color: #BBBBBB;
}
.highlight .nf {
  color: #a8e1fe;
}
.highlight .py {
  color: #a8e1fe;
}
.highlight .na {
  color: #a8e1fe;
}
.highlight .nv, .highlight .vc, .highlight .vg, .highlight .vi {
  color: #a8e1fe;
  font-weight: bold;
}	.article img {
		border: 1px solid #bbb;
		display: block;
		margin-left: auto;
		margin-right: auto;
		padding: 10px;
	}
	@media print {
		#disqus_thread, #sidebar {
    			display:none;
  		}
	}
</style> <link href="https://plus.google.com/101694420547181110548" rel=publisher /> </head> <body class="java-tuples java-tuples_index"> <div class=container> <div class=row> <div class="col-md-9 article"> <h1>Java Tuples</h1> <table class=table> <tr> <td> <center> <a href="//selenium-webdriver-in-practice.github.io"><img src="/images/liang_cover100.jpg" class=thumbnail /></a> </center> </td> <td> <p class=well><b>Big news!</b> I've been working hard getting <b>Selenium WebDriver in Practice</b> ready and it is now available to buy on the <a href="//selenium-webdriver-in-practice.github.io">Manning Early Access Program</a>. It provides practical and useful techniques you can use with WebDriver, to get the very best out of it in your projects.</p> </td> </tr> </table> <p>Tuples are an <a href="//en.wikipedia.org/wiki/Tuple">order sequences of elements</a>. They are not supported in Java, but are a couple of great reasons to support them:</p> <ul> <li>They provide a way, to group objects together that can greatly reduce the amount of boiler plate "value object" code needed.</li> <li>They <em>can</em> improve performance, by reducing the number of object dereferences when accessing arrays of objects. </li> </ul> <p>In peer languages of Java, both Scala and C# support tuples. E.g.</p> <table> <tbody> <tr> <td>Scala:</td> <td><code>val x = (0, false)</code></td> </tr> <tr> <td>C#:</td> <td><code>var x = Tuple.Create(0, false);</code></td> </tr> <tr> <td>Haskel:</td> <td><code>let x = (0, false)</code></td> </tr> <tr> <td>Erlang:</td> <td><code>P = {0, false}</code></td> </tr> </tbody> </table> <p>It's easy to think of a tuple as a type of collection, and some implementations of tuples for Java are collection like.</p> <h2 id=homogeneous-heterogeneous-and-primitive-tuples>Homogeneous, Heterogeneous and Primitive Tuples</h2> <p>Java already supports a tidy kind of <em>homogeneous tuple</em>: the humble array.</p> <pre class="highlight java"><span class="kt">int</span><span class="o">[]</span> <span class="n">tuple2</span> <span class="o">=</span> <span class="o">{</span><span class="mi">0</span><span class="o">,</span><span class="mi">1</span><span class="o">};</span>
</pre> <p><em>Heterogeneous tuples</em> (where types are mixed) can be put into an `Object[]', but require casting. </p> <pre class="highlight java"><span class="kt">int</span><span class="o">[]</span> <span class="kt">int</span><span class="n">OnlyTuple</span> <span class="o">=</span> <span class="o">{</span><span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">};</span>
<span class="n">Integer</span><span class="o">[]</span> <span class="kt">int</span><span class="n">egerOnlyTuple</span> <span class="o">=</span> <span class="o">{</span><span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">};</span>

<span class="n">Object</span><span class="o">[]</span> <span class="n">heteroTuple</span> <span class="o">=</span> <span class="o">{</span><span class="s">""</span><span class="o">,</span> <span class="n">Integer</span><span class="o">.</span><span class="na">class</span><span class="o">};</span>

<span class="n">String</span> <span class="n">_0</span> <span class="o">=</span> <span class="o">(</span><span class="n">String</span><span class="o">)</span><span class="n">heteroTuple</span><span class="o">[</span><span class="mi">0</span><span class="o">];</span>
<span class="n">Class</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">_1</span> <span class="o">=</span> <span class="o">(</span><span class="n">Class</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;)</span><span class="n">heteroTuple</span><span class="o">[</span><span class="mi">0</span><span class="o">];</span>
</pre> <p><em>Primitive tuples</em> are tuples that only contain primitive values. </p> <p>Note, that many of my examples will used boxed types (e.g. <code>Integer</code>) which also sub-class <code>Number</code>, or parameterised types (such as <code>Class&lt;Integer&gt;</code>).</p> <h2 id=naive-tuples-in-java>Naive Tuples in Java</h2> <p>A simple example of a tuple is a parameterised class, e.g.:</p> <pre class="highlight java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Tuple2</span><span class="o">&lt;</span><span class="n">T0</span><span class="o">,</span> <span class="n">T1</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="n">T0</span> <span class="n">_0</span><span class="o">;</span>
    <span class="kd">public</span> <span class="n">T1</span> <span class="n">_1</span><span class="o">;</span>
    
    <span class="n">pubilc</span> <span class="n">Tuple2</span><span class="o">(</span><span class="n">T0</span> <span class="n">_0</span><span class="o">,</span> <span class="n">T1</span> <span class="n">_1</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">_0</span> <span class="o">=</span> <span class="n">_0</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">_1</span> <span class="o">=</span> <span class="n">_1</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="n">equals</span><span class="o">(</span><span class="n">Object</span> <span class="n">o</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="k">this</span> <span class="o">==</span> <span class="n">o</span><span class="o">)</span> <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">o</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="n">getClass</span><span class="o">()</span> <span class="o">!=</span> <span class="n">o</span><span class="o">.</span><span class="na">getClass</span><span class="o">())</span> <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>

        <span class="n">Tuple2</span> <span class="n">tuple2</span> <span class="o">=</span> <span class="o">(</span><span class="n">Tuple2</span><span class="o">)</span> <span class="n">o</span><span class="o">;</span>

        <span class="k">if</span> <span class="o">(</span><span class="n">_0</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">?</span> <span class="o">!</span><span class="n">_0</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">tuple2</span><span class="o">.</span><span class="na">_0</span><span class="o">)</span> <span class="o">:</span> <span class="n">tuple2</span><span class="o">.</span><span class="na">_0</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">_1</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">?</span> <span class="o">!</span><span class="n">_1</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">tuple2</span><span class="o">.</span><span class="na">_1</span><span class="o">)</span> <span class="o">:</span> <span class="n">tuple2</span><span class="o">.</span><span class="na">_1</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>

        <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="n">hashCode</span><span class="o">()</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">result</span> <span class="o">=</span> <span class="n">_0</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">?</span> <span class="n">_0</span><span class="o">.</span><span class="na">hashCode</span><span class="o">()</span> <span class="o">:</span> <span class="mi">0</span><span class="o">;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="mi">31</span> <span class="o">*</span> <span class="n">result</span> <span class="o">+</span> <span class="o">(</span><span class="n">_1</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">?</span> <span class="n">_1</span><span class="o">.</span><span class="na">hashCode</span><span class="o">()</span> <span class="o">:</span> <span class="mi">0</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="n">toString</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">"("</span> <span class="o">+</span> <span class="n">_0</span> <span class="o">+</span> <span class="sc">','</span> <span class="o">+</span> <span class="n">_1</span> <span class="o">+</span> <span class="sc">')'</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre> <p>There's a few problems with this class, and we'll address each in turn.</p> <h2 id=immutability>Immutability</h2> <p>Tuples implementations are generally immutable. Immutable objects have a stable hash code and makes then more usable in common collectsions such as the <code>HashMap</code>, and better for caching. This requires each element to be immutable, but there's no way to enforce this. Instead, we can at most mark the fields as final.</p> <pre class="highlight java"><span class="kd">public</span> <span class="kd">final</span> <span class="n">T0</span> <span class="n">_0</span><span class="o">;</span>
<span class="kd">public</span> <span class="kd">final</span> <span class="n">T1</span> <span class="n">_1</span><span class="o">;</span>
</pre> <h2 id=type-inference>Type Inference</h2> <p>To create one of these, we need to provide the types:</p> <pre class="highlight java"><span class="n">Tuple2</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">Boolean</span><span class="o">&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Tuple2</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">Boolean</span><span class="o">&gt;(</span><span class="mi">0</span><span class="o">,</span> <span class="kc">true</span><span class="o">);</span>
</pre> <p>By providing a static constructor, we can have the type implied, resulting in fewer character and more easy to read code.</p> <pre class="highlight java"><span class="n">Tuple2</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">Boolean</span><span class="o">&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">Tuple2</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="kc">false</span><span class="o">);</span>
</pre> <h2 id=null-elements>Null Elements</h2> <p>Null in Java is a "bottom type", it can be cast to any type (like <code>Nothing</code> in Scala). We allow nulls here, but lets quickly consider the inferred type of a tuples with nulls.</p> <pre class="highlight java"><span class="n">Tuple2</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Tuple2</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">,</span><span class="n">Object</span><span class="o">&gt;(</span><span class="kc">null</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>
</pre> <h2 id=serializable-cloneable--comparable>Serializable, Cloneable &amp; Comparable</h2> <p>Each of these are commonly implemented, and useful.</p> <p><code>List</code> is not serialisable, but <code>ArrayList</code> (and many other implementations of collections) are. Essentially we treat serialisability as a property of a class that must be determined at runtime. <code>Cloneable</code> is a marker interface, like <code>Serializable</code>, that implies runtime checking. There's no implementation code needed for either <code>Cloneable</code> or <code>Serializable</code>. For <code>Comparable</code>, the implementation is simple:</p> <pre class="highlight java"><span class="nd">@Override</span>
<span class="nd">@SuppressWarnings</span><span class="o">(</span><span class="s">"unchecked"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kt">int</span> <span class="nf">compareTo</span><span class="p">(</span><span class="n">Tuple2</span><span class="o">&lt;</span><span class="n">T0</span><span class="o">,</span> <span class="n">T1</span><span class="o">&gt;</span> <span class="n">o</span><span class="o">)</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="o">((</span><span class="n">Comparable</span><span class="o">&lt;</span><span class="n">T0</span><span class="o">&gt;)</span><span class="n">_0</span><span class="o">).</span><span class="na">compareTo</span><span class="o">(</span><span class="n">o</span><span class="o">.</span><span class="na">_0</span><span class="o">);</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">i</span> <span class="o">!=</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span><span class="k">return</span> <span class="n">i</span><span class="o">;}</span>
    <span class="k">return</span> <span class="o">((</span><span class="n">Comparable</span><span class="o">&lt;</span><span class="n">T1</span><span class="o">&gt;)</span><span class="n">_1</span><span class="o">).</span><span class="na">compareTo</span><span class="o">(</span><span class="n">o</span><span class="o">.</span><span class="na">_1</span><span class="o">);</span>
<span class="o">}</span>
</pre> <p>As a footnote, when we mark a class as <code>Serializable</code>, we might consider, for performance reasons, providing implementations of <code>writeObject</code> and <code>readObject</code>. This is also a consideration for whether or not we mark the class final.</p> <h2 id=typing>Typing</h2> <p>When using tuples, you may might need to use bounded wildcards, this example wouldn't work if you used <code>Tuple&lt;Number,Boolean&gt;</code>:</p> <pre class="highlight java"><span class="n">Tuple2</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">Number</span><span class="o">,</span><span class="n">Boolean</span><span class="o">&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">Tuple2</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="mi">0</span><span class="n">f</span><span class="o">,</span> <span class="kc">false</span><span class="o">);</span> <span class="c1">// Tuple&lt;Float,Boolean&gt;</span>
	
<span class="n">x</span> <span class="o">=</span> <span class="n">Tuple2</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="kc">false</span><span class="o">);</span> <span class="c1">// Tuple2&lt;Integer,Boolean&gt;</span>
</pre> <h2 id=tuples-as-functions-arity>Tuples as Functions, Arity</h2> <p>Tuples, like maps, can be treated as functions, in Java 8 we can create an interface for Tuple, which extends <code>IntFunction</code> and provide a <code>size()</code> method (for consistency with <code>Collection</code>) to get it's arity:</p> <pre class="highlight java"><span class="kd">public</span> <span class="kt">int</span><span class="n">erface</span> <span class="n">Tuple</span><span class="o">&lt;</span><span class="n">T</span> <span class="kd">extends</span> <span class="n">Tuple</span><span class="o">&gt;</span> <span class="kd">extends</span> <span class="n">IntFunction</span><span class="o">,</span> <span class="n">Serializable</span><span class="o">,</span> <span class="n">Cloneable</span><span class="o">,</span> <span class="n">Comparable</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">{</span>

   	<span class="kt">int</span> <span class="n">size</span><span class="o">();</span>
<span class="o">}</span>
</pre> <p>For <code>Tuple2</code> we have simple implementations of <code>apply(..)</code> and <code>size()</code>:</p> <pre class="highlight java"><span class="nd">@Override</span>
<span class="kd">public</span> <span class="n">Object</span> <span class="nf">apply</span><span class="p">(</span><span class="kt">int</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">switch</span> <span class="o">(</span><span class="n">value</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">case</span> <span class="mi">0</span><span class="o">:</span>
            <span class="k">return</span> <span class="n">_0</span><span class="o">;</span>
        <span class="k">case</span> <span class="mi">1</span><span class="o">:</span>
            <span class="k">return</span> <span class="n">_1</span><span class="o">;</span>
        <span class="k">default</span><span class="o">:</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="n">IndexOutOfBoundsException</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="nd">@Override</span>
<span class="kd">public</span> <span class="kt">int</span> <span class="nf">size</span><span class="p">(</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="mi">2</span><span class="o">;</span>
<span class="o">}</span>
</pre> <p>In Java 8 we can have a very nice default implementation for <code>compareTo(..)</code> in <code>Tuple</code> that'll work for all sizes of tuples:</p> <pre class="highlight java"><span class="nd">@Override</span>
<span class="k">default</span> <span class="kt">int</span> <span class="nf">compareTo</span><span class="p">(</span><span class="n">T</span> <span class="n">o</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">Objects</span><span class="o">.</span><span class="na">requireNonNull</span><span class="o">(</span><span class="n">o</span><span class="o">);</span>
    <span class="k">if</span> <span class="o">(!</span><span class="n">getClass</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="n">o</span><span class="o">.</span><span class="na">getClass</span><span class="o">()))</span> <span class="o">{</span>
        <span class="k">throw</span> <span class="k">new</span> <span class="n">ClassCastException</span><span class="o">(</span><span class="n">o</span><span class="o">.</span><span class="na">getClass</span><span class="o">()</span> <span class="o">+</span> <span class="s">" must equal "</span> <span class="o">+</span> <span class="n">getClass</span><span class="o">());</span>
    <span class="o">}</span>

    <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">size</span><span class="o">();</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
        <span class="nd">@SuppressWarnings</span><span class="o">(</span><span class="s">"unchecked"</span><span class="o">)</span>
        <span class="n">Comparable</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span> <span class="n">l</span> <span class="o">=</span> <span class="o">(</span><span class="n">Comparable</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;)</span> <span class="n">apply</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
        <span class="n">Object</span> <span class="n">r</span> <span class="o">=</span> <span class="n">o</span><span class="o">.</span><span class="na">apply</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
        <span class="kt">int</span> <span class="n">c</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="na">compareTo</span><span class="o">(</span><span class="n">r</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">c</span> <span class="o">!=</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">c</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="k">return</span> <span class="mi">0</span><span class="o">;</span>
<span class="o">}</span>
</pre> <p>And as Java 8 now supports static methods on interfaces, some nice factory methods:</p> <pre class="highlight java"><span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T0</span><span class="o">&gt;</span> <span class="n">Tuple1</span><span class="o">&lt;</span><span class="n">T0</span><span class="o">&gt;</span> <span class="n">valueOf</span><span class="o">(</span><span class="n">T0</span> <span class="n">_0</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">Tuple1</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">_0</span><span class="o">);</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T0</span><span class="o">,</span> <span class="n">T1</span><span class="o">&gt;</span> <span class="n">Tuple2</span><span class="o">&lt;</span><span class="n">T0</span><span class="o">,</span> <span class="n">T1</span><span class="o">&gt;</span> <span class="n">valueOf</span><span class="o">(</span><span class="n">T0</span> <span class="n">_0</span><span class="o">,</span> <span class="n">T1</span> <span class="n">_1</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">Tuple2</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">_0</span><span class="o">,</span> <span class="n">_1</span><span class="o">);</span>
<span class="o">}</span>

<span class="kd">public</span> <span class="kd">static</span> <span class="o">&lt;</span><span class="n">T0</span><span class="o">,</span> <span class="n">T1</span><span class="o">,</span> <span class="n">T2</span><span class="o">&gt;</span> <span class="n">Tuple3</span><span class="o">&lt;</span><span class="n">T0</span><span class="o">,</span> <span class="n">T1</span><span class="o">,</span> <span class="n">T2</span><span class="o">&gt;</span> <span class="n">valueOf</span><span class="o">(</span><span class="n">T0</span> <span class="n">_0</span><span class="o">,</span> <span class="n">T1</span> <span class="n">_1</span><span class="o">,</span> <span class="n">T2</span> <span class="n">_2</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="n">Tuple3</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">_0</span><span class="o">,</span> <span class="n">_1</span><span class="o">,</span> <span class="n">_2</span><span class="o">);</span>
<span class="o">}</span> 
</pre> <p>Which mean you create all tuples using the same code and therefore don't have to consider "how big is my tuple?":</p> <pre class="highlight java"><span class="n">Tuple2</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">Boolean</span><span class="o">&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">Tuple</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="kc">false</span><span class="o">);</span>
<span class="n">Tuple3</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">Float</span><span class="o">,</span><span class="n">Boolean</span><span class="o">&gt;</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Tuple</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="n">f</span><span class="o">,</span> <span class="kc">false</span><span class="o">);</span>
</pre> <h2 id=sub-classing-tuples>Sub-Classing Tuples</h2> <p>A good example of a simple tuple is <code>Point</code>:</p> <pre class="highlight java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Point</span> <span class="kd">extends</span> <span class="n">Tuple2</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="n">Point</span><span class="o">(</span><span class="n">Integer</span> <span class="n">_0</span><span class="o">,</span> <span class="n">Integer</span> <span class="n">_1</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">(</span><span class="n">_0</span><span class="o">,</span> <span class="n">_1</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre> <p>I now have to access x and y as <code>_0 </code>and <code>_1</code>. Not really very handy. What we want is tuples with <em>named elements</em>. Lombok provides a <a href="//projectlombok.org/features/Data.html">nice <code>@Data</code> annotation</a>, that takes the skeleton of a value object and creates <code>equals</code>, <code>hashCode</code>, getters and setter when it is complied:</p> <pre class="highlight java"><span class="nd">@Data</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Point</span> <span class="o">{</span>
	<span class="kd">private</span> <span class="kd">final</span> <span class="kt">int</span> <span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">;</span>
	<span class="c1">// yes, it's an invalid java file, but will still compile</span>
<span class="o">}</span>
</pre> <p>As we now don't plan to sub-class tuples, I'll make them final.</p> <h2 id=unpacking-tuples><em>Unpacking</em> Tuples</h2> <p>Currently tuples you have a packed into, by which I mean, you still have to deference each element as follows:</p> <pre class="highlight java"><span class="n">Tuple2</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span><span class="n">Boolean</span><span class="o">&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">Tuple</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="kc">false</span><span class="o">);</span>
<span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="na">_0</span><span class="o">;</span>
<span class="kt">boolean</span> <span class="n">b</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="na">_1</span><span class="o">;</span>
</pre> <p>Scala uses <em>pattern matching</em> to unpack the values, how can we do this in Java? We can't.</p> <p><a href="https://github.com/alexec/tuples">Code on Github</a> as usual.</p> <h2 id=references>References</h2> <ul> <li><a href="//citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.96.6578&amp;amp;rep=rep1&amp;amp;type=pdf">Adding tuples to Java: a study in lightweight data structures</a></li> <li><a href="//mechanical-sympathy.blogspot.co.uk/2012/10/compact-off-heap-structurestuples-in.html">Compact Off-Heap Structures/Tuples In Java</a></li> </ul> <h4>Related</h4> <ol> <li><a href="/tutorial-swing-synth-plaf-template-part-8-check-boxes-and-radio-buttons/">Tutorial: Swing Synth PLAF Template - Part 8: Check-boxes and Radio-buttons</a></li> <li><a href="/spring-boot-performance/">Spring Boot Performance</a></li> <li><a href="/polyglot-maven-first-steps/">Polyglot Maven First Steps</a></li> <li><a href="/java-annotation-processor-tutorial/">Java Annotation Processor Tutorial</a></li> <li><a href="/documenting-junit-tests/">Documenting XML APIs Tests</a></li> </ol> <div id=disqus_thread></div> <script>
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'alexecollins'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script> <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript> </div> <div class=col-md-3 id=sidebar> <center> <h2>Alex Collins</h2> <p> <a href="/"><img src="/images/alex-collins-circle.png"/></a> </p> </center> <p> Java technical lead and solutions architect in London for the UK IT industry for over ten years. <a href="/about-me">more...</a> </p> <h4>Docker Maven Plugin</h4> <p>Version 2.11.7 released, <a href="https://github.com/alexec/docker-maven-plugin/blob/master/CHANGELOG.md">more...</a></p> <pre style="font-size:50%">&lt;dependency&gt;
  &lt;groupId&gt;com.alexecollins.docker&lt;/groupId&gt;
  &lt;artifactId&gt;docker-maven-plugin&lt;/artifactId&gt;
  &lt;version&gt;2.11.7&lt;/version&gt;
&lt;/dependency&gt;</pre> <h4>Recent</h4> <ul> <li><a href="/developing-with-docker-debug-container/">Developing With Docker - The Debug Container</a> <span>Dec 9</span></li> <li><a href="/developing-with-docker-proxy-container/">Developing With Docker - Using A Proxy Container To Make Development Easier</a> <span>Nov 28</span></li> <li><a href="/practical-domain-specific-language-tutorial/">Practical Java Domain Specific Language Tutorial</a> <span>Sep 19</span></li> <li><a href="/sonarqube-and-java-8/">Sonarqube And Java 8</a> <span>Sep 17</span></li> <li><a href="/spring-boot-performance/">Spring Boot Performance</a> <span>Sep 5</span></li> </ul> <h4>Tags</h4> <a href="/tags/ci/">ci</a> (3)</a>&nbsp;&nbsp; <a href="/tags/concurrency/">concurrency</a> (4)</a>&nbsp;&nbsp; <a href="/tags/docker/">docker</a> (12)</a>&nbsp;&nbsp; <a href="/tags/gist/">gist</a> (13)</a>&nbsp;&nbsp; <a href="/tags/groovy/">groovy</a> (4)</a>&nbsp;&nbsp; <a href="/tags/java/">java</a> (48)</a>&nbsp;&nbsp; <a href="/tags/jmeter/">jmeter</a> (3)</a>&nbsp;&nbsp; <a href="/tags/junit/">junit</a> (7)</a>&nbsp;&nbsp; <a href="/tags/links/">links</a> (14)</a>&nbsp;&nbsp; <a href="/tags/maven/">maven</a> (18)</a>&nbsp;&nbsp; <a href="/tags/oped/">oped</a> (8)</a>&nbsp;&nbsp; <a href="/tags/performance/">performance</a> (6)</a>&nbsp;&nbsp; <a href="/tags/plaf/">plaf</a> (14)</a>&nbsp;&nbsp; <a href="/tags/ruby/">ruby</a> (3)</a>&nbsp;&nbsp; <a href="/tags/selenium/">selenium</a> (9)</a>&nbsp;&nbsp; <a href="/tags/software/">software</a> (10)</a>&nbsp;&nbsp; <a href="/tags/spring/">spring</a> (7)</a>&nbsp;&nbsp; <a href="/tags/swing/">swing</a> (15)</a>&nbsp;&nbsp; <a href="/tags/testing/">testing</a> (23)</a>&nbsp;&nbsp; <a href="/tags/tips/">tips</a> (4)</a>&nbsp;&nbsp; <a href="/tags/tomcat/">tomcat</a> (3)</a>&nbsp;&nbsp; <a href="/tags/unix/">unix</a> (6)</a>&nbsp;&nbsp; <a href="/tags/web/">web</a> (4)</a>&nbsp;&nbsp; </hr/> <p> <a class="btn btn-primary btn-xs" href="/sitemap">Sitemap</a> <a class="btn btn-primary btn-xs" href="/feed.xml">RSS</a> <a class="btn btn-primary btn-xs" href="//uk.linkedin.com/in/alexecollins">LinkedIn</a> </p> </div> </div> <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-25388993-1', 'auto');
  ga('require', 'linkid', 'linkid.js');
  ga('send', 'pageview');

</script> </body> </html>