<!doctype html> <html> <head> <meta charset=utf-8 /> <meta http-equiv=X-UA-Compatible content='IE=edge;chrome=1'/> <meta name=viewport content="width=device-width, initial-scale=1.0"> <meta name=google-site-verification content=459WLyNfyiKwT7T3IzdCjzIpNP-IVQSOb4tR8b2vQhI /> <title>Alex Collins - Selenium and Continuous Integration</title> <link href="/css/bootstrap.min.css" media=screen rel=stylesheet /> <style type="text/css">
.highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight {
  color: #faf6e4;
  background-color: #122b3b;
}
.highlight .gl {
  color: #dee5e7;
  background-color: #4e5d62;
}
.highlight .c, .highlight .cd, .highlight .cm, .highlight .c1, .highlight .cs {
  color: #6c8b9f;
  font-style: italic;
}
.highlight .cp {
  color: #b2fd6d;
  font-weight: bold;
  font-style: italic;
}
.highlight .err {
  color: #fefeec;
  background-color: #cc0000;
}
.highlight .gr {
  color: #fefeec;
  background-color: #cc0000;
}
.highlight .k, .highlight .kd, .highlight .kv {
  color: #f6dd62;
  font-weight: bold;
}
.highlight .o, .highlight .ow {
  color: #4df4ff;
}
.highlight .p, .highlight .pi {
  color: #4df4ff;
}
.highlight .gd {
  color: #cc0000;
}
.highlight .gi {
  color: #b2fd6d;
}
.highlight .ge {
  font-style: italic;
}
.highlight .gs {
  font-weight: bold;
}
.highlight .gt {
  color: #dee5e7;
  background-color: #4e5d62;
}
.highlight .kc {
  color: #f696db;
  font-weight: bold;
}
.highlight .kn {
  color: #ffb000;
  font-weight: bold;
}
.highlight .kp {
  color: #ffb000;
  font-weight: bold;
}
.highlight .kr {
  color: #ffb000;
  font-weight: bold;
}
.highlight .gh {
  color: #ffb000;
  font-weight: bold;
}
.highlight .gu {
  color: #ffb000;
  font-weight: bold;
}
.highlight .kt {
  color: #b2fd6d;
  font-weight: bold;
}
.highlight .no {
  color: #b2fd6d;
  font-weight: bold;
}
.highlight .nc {
  color: #b2fd6d;
  font-weight: bold;
}
.highlight .nd {
  color: #b2fd6d;
  font-weight: bold;
}
.highlight .nn {
  color: #b2fd6d;
  font-weight: bold;
}
.highlight .bp {
  color: #b2fd6d;
  font-weight: bold;
}
.highlight .ne {
  color: #b2fd6d;
  font-weight: bold;
}
.highlight .nl {
  color: #ffb000;
  font-weight: bold;
}
.highlight .nt {
  color: #ffb000;
  font-weight: bold;
}
.highlight .m, .highlight .mf, .highlight .mh, .highlight .mi, .highlight .il, .highlight .mo, .highlight .mb, .highlight .mx {
  color: #f696db;
  font-weight: bold;
}
.highlight .ld {
  color: #f696db;
  font-weight: bold;
}
.highlight .ss {
  color: #f696db;
  font-weight: bold;
}
.highlight .s, .highlight .sb, .highlight .sd, .highlight .s2, .highlight .sh, .highlight .sx, .highlight .sr, .highlight .s1 {
  color: #fff0a6;
  font-weight: bold;
}
.highlight .se {
  color: #4df4ff;
  font-weight: bold;
}
.highlight .sc {
  color: #4df4ff;
  font-weight: bold;
}
.highlight .si {
  color: #4df4ff;
  font-weight: bold;
}
.highlight .nb {
  font-weight: bold;
}
.highlight .ni {
  color: #999999;
  font-weight: bold;
}
.highlight .w {
  color: #BBBBBB;
}
.highlight .nf {
  color: #a8e1fe;
}
.highlight .py {
  color: #a8e1fe;
}
.highlight .na {
  color: #a8e1fe;
}
.highlight .nv, .highlight .vc, .highlight .vg, .highlight .vi {
  color: #a8e1fe;
  font-weight: bold;
}	.article img {
		border: 1px solid #bbb;
		display: block;
		margin-left: auto;
		margin-right: auto;
		padding: 10px;
	}
	@media print {
		#disqus_thread, #sidebar {
    			display:none;
  		}
	}
</style> <link href="https://plus.google.com/101694420547181110548" rel=publisher /> </head> <body class="selenium-and-continuous-integration selenium-and-continuous-integration_index"> <div class=container> <div class=row> <div class="col-md-9 article"> <h1>Selenium and Continuous Integration</h1> <table class=table> <tr> <td> <center> <a href="//selenium-webdriver-in-practice.github.io"><img src="/images/liang_cover100.jpg" class=thumbnail /></a> </center> </td> <td> <p class=well><b>Big news!</b> I've been working hard getting <b>Selenium WebDriver in Practice</b> ready and it is now available to buy on the <a href="//selenium-webdriver-in-practice.github.io">Manning Early Access Program</a>. It provides practical and useful techniques you can use with WebDriver, to get the very best out of it in your projects.</p> </td> </tr> </table> <h2 id=overview>Overview</h2> <p>This article covers:</p> <ul> <li>Why you would want to use continuous integration.</li> <li>The main tools you'll use.</li> <li>Some important strategies when testing.</li> </ul> <p>We'll assume you are familiar with using a terminal or command prompt. </p> <p>Source code can be found on <a href="https://github.com/alexec/selenium-ci">Github</a>.</p> <h2 id=why-ci>Why CI?</h2> <p>One of the main ways you can improve the speed and quality of your testing is to run your tests on a CI server. This has a number of benefits to be gained by running them on a Continuous Integration server compared to only running them manually on your own desktop machine.</p> <ol> <li>It frees up your desktop machine for writing code.</li> <li>You don't need to be told to run the test each time your application has a code change. The CI can build the application, deploy it and then run your tests automatically.</li> <li>Your CI can be set-up to run each test in different browsers, making cross-browser testing much easier.</li> <li>Your CI can also run each test in different languages, different time zones, and different times of day.</li> <li>Your CI can record information about each run and store it in database, so you can refer back at a later time to see just when a problem started occurring.</li> <li>You can configure your CI to run the tests on a regular basis, so that if anything changes, you'll get notified.</li> <li>If a problem occurs with a test, you don't need to tell the developer. The CI will notify you and your team automatically via email.</li> </ol> <p>There's a number of different strategies for running tests, closely related to how you set-up your test environments. Each has a set of pros and cons. We'll talk a little bit about this, and we'll talk a little about some popular commercial and open source systems you can use.</p> <h2 id=build-tools>Build Tools</h2> <p>A build tool is a piece of software that actually builds your application and typically packages it into a single binary file. There's a number build tools you can choose from, here are a couple of popular ones:</p> <ul> <li><a href="//maven.apache.org">Maven</a> is the most popular build tool on the JVM. It uses the philosophy of "convention over configuration". This not only means it is easy to understand, it has excellent support and integration into IDEs and CI servers.</li> <li><a href="//ant.apache.org">Ant</a> is Java's venerable build tool. It's still quite common.</li> <li><a href="//www.gradle.org">Gradle</a> is a Groovy based build tool that is extremely flexible. It’s DSL based system is a bit more esoteric that Maven, but it is popular for complex builds.</li> </ul> <h2 id=binary-repository>Binary Repository</h2> <p>A binary repository is where you store your application once it's build. All have a common set of feature, such as security, the ability to search and query artefacts, and a web interface to manage it. Here are two you might consider:</p> <ul> <li><a href="//www.sonatype.com/nexus">Sonatype Nexus</a> has both a supported commercial version and a free open source version.</li> <li><a href="//www.jfrog.com/open-source/">Artifactory</a> also has commercial and open source versions.</li> </ul> <h2 id=ci-server>CI Server</h2> <p>Your CI server is the computer that actually calls the build tool to build your application. All CI servers tend support a common set of features such as executing builds either manually, on a schedule or whenever the source code changes; creating historical reports on your builds, storing the output from tests, and emailing or instant messaging you when there's a problem. Here are some popular CI servers:</p> <ul> <li><a href="//jenkins-ci.org">Jenkins</a> is an open source version of <strong>Hudson</strong>. It's extremely popular, is very well supported, and has a cornucopia of plugins. Some say it is starting to show it ages these days, but I’m betting it has a lot of life in it.</li> <li><a href="//www.thoughtworks.com/products/go-continuous-delivery">Go</a> is a CI server created from Thoughtworks. It has both a commercial and open source version.</li> <li><a href="https://www.jetbrains.com/teamcity">TeamCity</a> is a server from JetBrains.</li> <li><a href="https://www.atlassian.com/software/bamboo">Bamboo</a> is a commercial tool from Atlassian, who are best known for their JIRA and Confluence applications. It's very well integrated into those.</li> <li><a href="https://travis-ci.org">Travis CI</a> and <a href="https://drone.io">Drone.IO</a> are both commercial/open source CI servers that by default run builds on isolated virtual machines.</li> </ul> <h2 id=continuous-integration-test-strategies>Continuous Integration Test Strategies</h2> <p>In a typical strategy you'll want to do a number of basic steps:</p> <ol> <li>Create a binary build of the web application you are testing.</li> <li>Copy that build to a repository for safekeeping.</li> <li>Set-up your test system to a known initial state.</li> <li>Deploy your binary to your test system.</li> <li>Run your tests on your CI.</li> <li>Create a report and save it in your CI's database.</li> <li>Inform someone that the tests have been run.</li> <li>Optionally, clean-up.</li> <li>Potentially, deploy the binary to your production system.</li> </ol> <p>You've got a few options on how you can run this. I imagine you're already using one of the great build tools such as Maven. What you need to decide on is where you're going to run your application and how you set-up up your test system.</p> <h2 id=running-your-application-under-test>Running your application under test</h2> <p>You can run your application in one of two places. The first is <strong>locally</strong> on the machine that runs the tests, and second is on a dedicated test system. Running tests on the local machine will simplify the set-up of the tests, they can always talk to localhost. It might be quite easy to initialise the local system to a known state, you don't need dedicated computers set-up ready for testing, and if you can run it on your local machines, you can always run your tests before you share your change.</p> <p>However, you might be using a commercial database who's license agreement means you can't install it locally, or you might be unable to have some required service such on JNDI or JMS running. These mean you'll have to run your tests on a dedicated <strong>remote</strong> system means you'll need to set-up and maintain that system, for cost reasons you may have to share it with other teams, which might mean that initialising it into a known state might not be feasible.</p> <p>If you want some guidance as to which option to use, I'd try and use the first to start with, as it's generally cheaper, and it's often quicker to determine if that's feasible and then move to a dedicate system if it is not, than vice-versa. </p> <h3 id=setting-up-maven-to-run-your-application-locally>Setting up Maven to run your application locally</h3> <p>Let do an example of a local The Cargo plugin will start and stop a test system before and after your tests have run. Lets work through an example.</p> <p>Create a Maven project using the web app archetype:</p> <pre class="highlight plaintext">mvn archetype:generate -DarchetypeGroupId=org.apache.maven.archetypes -DarchetypeArtifactId=maven-archetype-webapp -DarchetypeVersion=1.0 -DgroupId=sip -DartifactId=ci -Dversion=1.0.0-SNAPSHOT -B
</pre> <p>Test that this will build by using:</p> <pre class="highlight plaintext">mvn verify
</pre> <p>Now add the Cargo plugin section to the build section of your <code>pom.xml</code>.</p> <pre class="highlight xml"><span class="nt">&lt;plugins&gt;</span>
	<span class="nt">&lt;plugin&gt;</span>
		<span class="nt">&lt;groupId&gt;</span>org.codehaus.cargo<span class="nt">&lt;/groupId&gt;</span>
		<span class="nt">&lt;artifactId&gt;</span>cargo-maven2-plugin<span class="nt">&lt;/artifactId&gt;</span>
		<span class="nt">&lt;version&gt;</span>1.4.10<span class="nt">&lt;/version&gt;</span>
	<span class="nt">&lt;/plugin&gt;</span>
<span class="nt">&lt;/plugins&gt;</span>
</pre> <p>You can check this works using:</p> <pre class="highlight plaintext">mvn cargo:run
</pre> <p>This will start your server and you can check your application is running by opening <a href="//localhost:8080/ci">http://localhost:8080/ci</a>, you should see "Hello World!". Let's write a basic test using what we've already learnt. Add this to the <code>dependencies</code> section of the <code>pom.xml</code>:</p> <pre class="highlight xml"><span class="nt">&lt;dependency&gt;</span>
	<span class="nt">&lt;groupId&gt;</span>org.seleniumhq.selenium<span class="nt">&lt;/groupId&gt;</span>
	<span class="nt">&lt;artifactId&gt;</span>selenium-java<span class="nt">&lt;/artifactId&gt;</span>
	<span class="nt">&lt;version&gt;</span>2.43.1<span class="nt">&lt;/version&gt;</span>
	<span class="nt">&lt;scope&gt;</span>test<span class="nt">&lt;/scope&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</pre> <p>Let's use a later version of JUnit (it's got more features):</p> <pre class="highlight xml"><span class="nt">&lt;dependency&gt;</span>
	<span class="nt">&lt;groupId&gt;</span>junit<span class="nt">&lt;/groupId&gt;</span>
	<span class="nt">&lt;artifactId&gt;</span>junit<span class="nt">&lt;/artifactId&gt;</span>
	<span class="nt">&lt;version&gt;</span>4.11<span class="nt">&lt;/version&gt;</span>
	<span class="nt">&lt;scope&gt;</span>test<span class="nt">&lt;/scope&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</pre> <p>Let's create a test to make sure that "Hello Word!" is displayed on the home page. Create <code>src/test/java/ci/HomepageIT.java</code></p> <pre class="highlight java"><span class="kn">package</span> <span class="n">ci</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.After</span><span class="o">;</span> 
<span class="kn">import</span> <span class="nn">org.junit.Before</span><span class="o">;</span> 
<span class="kn">import</span> <span class="nn">org.junit.Test</span><span class="o">;</span> 
<span class="kn">import</span> <span class="nn">org.openqa.selenium.By</span><span class="o">;</span> 
<span class="kn">import</span> <span class="nn">org.openqa.selenium.WebDriver</span><span class="o">;</span> 
<span class="kn">import</span> <span class="nn">org.openqa.selenium.firefox.FirefoxDriver</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">static</span> <span class="n">org</span><span class="o">.</span><span class="na">junit</span><span class="o">.</span><span class="na">Assert</span><span class="o">.</span><span class="na">assertEquals</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">HomepageIT</span> <span class="o">{</span>

	<span class="kd">private</span> <span class="n">WebDriver</span> <span class="n">driver</span><span class="o">;</span>
	
	<span class="nd">@Before</span> <span class="kd">public</span> <span class="kt">void</span> <span class="n">setUp</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span> <span class="n">driver</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FirefoxDriver</span><span class="o">();</span> <span class="o">}</span>
	
	<span class="nd">@After</span> <span class="kd">public</span> <span class="kt">void</span> <span class="n">tearDown</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span> <span class="n">driver</span><span class="o">.</span><span class="na">close</span><span class="o">();</span> <span class="o">}</span>

	<span class="nd">@Test</span> <span class="kd">public</span> <span class="kt">void</span> <span class="n">testHomepage</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
		<span class="n">driver</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"http://localhost:8080/ci"</span><span class="o">);</span>
		
		<span class="n">assertEquals</span><span class="o">(</span><span class="s">"Hello World!"</span><span class="o">,</span> <span class="n">driver</span><span class="o">.</span><span class="na">findElement</span><span class="o">(</span><span class="n">By</span><span class="o">.</span><span class="na">tagName</span><span class="o">(</span><span class="s">"h2"</span><span class="o">)).</span><span class="na">getText</span><span class="o">());</span> 
	<span class="o">}</span> 
<span class="o">}</span> 
</pre> <p>What we want to do is start and stop the server before and after running our integration tests. We often don't want to run the tests as part of the default build, as they can be time consuming. We'll add a profile to our build to run our just our integration tests:</p> <pre class="highlight xml"><span class="nt">&lt;profiles&gt;</span>
	<span class="nt">&lt;profile&gt;</span>
		<span class="nt">&lt;id&gt;</span>run-its<span class="nt">&lt;/id&gt;</span>
	<span class="nt">&lt;/profile&gt;</span>
<span class="nt">&lt;/profiles&gt;</span>
</pre> <p>This will only be run if we activate it:</p> <pre class="highlight plaintext">mvn verify -Prun-its
</pre> <p>We can do this by adding the following lines within this new profile your <code>pom.xml</code>:</p> <pre class="highlight xml"><span class="nt">&lt;build&gt;</span>
    <span class="nt">&lt;plugins&gt;</span>
        <span class="nt">&lt;plugin&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>org.codehaus.cargo<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>cargo-maven2-plugin<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;executions&gt;</span>
                <span class="nt">&lt;execution&gt;</span>
                    <span class="nt">&lt;id&gt;</span>start<span class="nt">&lt;/id&gt;</span>
                    <span class="nt">&lt;phase&gt;</span>pre-integration-test<span class="nt">&lt;/phase&gt;</span>
                    <span class="nt">&lt;goals&gt;</span>
                        <span class="nt">&lt;goal&gt;</span>start<span class="nt">&lt;/goal&gt;</span>
                    <span class="nt">&lt;/goals&gt;</span>
                <span class="nt">&lt;/execution&gt;</span>
                <span class="nt">&lt;execution&gt;</span>
                    <span class="nt">&lt;id&gt;</span>stop<span class="nt">&lt;/id&gt;</span>
                    <span class="nt">&lt;phase&gt;</span>post-integration-test<span class="nt">&lt;/phase&gt;</span>
                    <span class="nt">&lt;goals&gt;</span>
                        <span class="nt">&lt;goal&gt;</span>stop<span class="nt">&lt;/goal&gt;</span>
                    <span class="nt">&lt;/goals&gt;</span>
                <span class="nt">&lt;/execution&gt;</span>
            <span class="nt">&lt;/executions&gt;</span>
        <span class="nt">&lt;/plugin&gt;</span>
    <span class="nt">&lt;/plugins&gt;</span>
<span class="nt">&lt;/build&gt;</span>
</pre> <p>Maven finally needs to be told to run the tests, and we can do this using the failsafe plugin which you can add to the <code>plugins</code> section of your <code>pom.xml</code>.</p> <pre class="highlight xml"><span class="nt">&lt;plugin&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>maven-failsafe-plugin<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;executions&gt;</span> 
        <span class="nt">&lt;execution&gt;</span> 
            <span class="nt">&lt;goals&gt;</span>
                <span class="nt">&lt;goal&gt;</span>integration-test<span class="nt">&lt;/goal&gt;</span>
                <span class="nt">&lt;goal&gt;</span>verify<span class="nt">&lt;/goal&gt;</span> 
            <span class="nt">&lt;/goals&gt;</span>
        <span class="nt">&lt;/execution&gt;</span> 
    <span class="nt">&lt;/executions&gt;</span>
<span class="nt">&lt;/plugin&gt;</span>
</pre> <p>Now you can have Maven start your application, run your tests, and clean up after itself, with just one command:</p> <pre class="highlight plaintext">mvn verify -Prun-its
</pre> <p>You'll see this line:</p> <pre class="highlight plaintext">Tests run: 1, Failures: 0, Errors: 0, Skipped: 0
</pre> <h3 id=setting-up-maven-to-run-your-application-remotely>Setting up Maven to run your application remotely</h3> <p>Now lets work through a <strong>remote</strong> example.</p> <p>If you're using a standard container such as Tomcat or JBoss, you can use the Cargo plugin for this as well. To run this example you'll need to do a bit extra work and install Tomcat locally. You can download Tomcat 8 it from <a href="//tomcat.apache.org/">http://tomcat.apache.org/</a>. Un-zip the download and open up the directory that is unpacked. By default, users are not enabled, so we need to configure one. From within the Tomcat directory, open <code>conf/tomcat-users.xml</code>, and add these lines inside the <code>tomcat-users</code> element:</p> <pre class="highlight xml"><span class="nt">&lt;role</span> <span class="na">rolename=</span><span class="s">"manager-script"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;role</span> <span class="na">rolename=</span><span class="s">"manager-gui"</span><span class="nt">/&gt;</span> 
<span class="nt">&lt;user</span> <span class="na">username=</span><span class="s">"admin"</span> <span class="na">password=</span><span class="s">"secret"</span> <span class="na">roles=</span><span class="s">"manager-script,manager-gui"</span><span class="nt">/&gt;</span>
</pre> <p>To start it up, open up a terminal, change directory into the unzipped directory and then and execute either <code>./bin/catalina.sh run</code> or <code>.\bin\catalina.bat run</code> (if you are on Windows). You should see the following:</p> <pre class="highlight plaintext">Server startup in 477 ms
</pre> <p>You can verify that it's worked by logging in to <a href="//localhost:8080/manager/html">http://localhost:8080/manager/html</a> using the username and password above. Next, we can update our <code>pom.xml</code> with the details needed to deploy the application. Change the Cargo's to look like this:</p> <pre class="highlight xml"><span class="nt">&lt;plugin&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>org.codehaus.cargo<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>cargo-maven2-plugin<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;executions&gt;</span> 
        <span class="nt">&lt;execution&gt;</span>
            <span class="nt">&lt;id&gt;</span>redeploy<span class="nt">&lt;/id&gt;</span>
            <span class="nt">&lt;phase&gt;</span>pre-integration-test<span class="nt">&lt;/phase&gt;</span> 
            <span class="nt">&lt;goals&gt;</span>
                <span class="nt">&lt;goal&gt;</span>redeploy<span class="nt">&lt;/goal&gt;</span> 
            <span class="nt">&lt;/goals&gt;</span>
        <span class="nt">&lt;/execution&gt;</span> 
    <span class="nt">&lt;/executions&gt;</span>
    <span class="nt">&lt;configuration&gt;</span> 
        <span class="nt">&lt;container&gt;</span>
            <span class="nt">&lt;containerId&gt;</span>tomcat8x<span class="nt">&lt;/containerId&gt;</span>
            <span class="nt">&lt;type&gt;</span>remote<span class="nt">&lt;/type&gt;</span> 
        <span class="nt">&lt;/container&gt;</span>
        <span class="nt">&lt;configuration&gt;</span> 
            <span class="nt">&lt;type&gt;</span>runtime<span class="nt">&lt;/type&gt;</span>
            <span class="nt">&lt;properties&gt;</span>
                <span class="nt">&lt;cargo.remote.username&gt;</span>admin<span class="nt">&lt;/cargo.remote.username&gt;</span>
                <span class="nt">&lt;cargo.remote.password&gt;</span>secret<span class="nt">&lt;/cargo.remote.password&gt;</span>
            <span class="nt">&lt;/properties&gt;</span> 
        <span class="nt">&lt;/configuration&gt;</span>
    <span class="nt">&lt;/configuration&gt;</span>
<span class="nt">&lt;/plugin&gt;</span>
</pre> <p>  We can ask Maven to build and deploy our application, and then run our tests, in the same one line.</p> <pre class="highlight plaintext">mvn verify -Prun-its
</pre> <p>Congratulations! You've now got a remote build ready to go!</p> <h2 id=how-to-set-up-your-tests>How to set-up your tests</h2> <p>You'll need to set-up your system in a known state. The ideal test is stateless - it requires no set-up before it's run, or tear-down afterwards: it's always in a known state. Unreliable or "flaky" tests are a massive maintenance problem. I'm sure you want to invest your time writing valuable new code rather than maintaining a test system. There's no better way to have unreliable tests that to have to hope that your test system is in a suitable state.</p> <p>There's two ways you can achieve this.</p> <ul> <li>The first way is to <strong>initialise</strong> your test system from scratch each time. For example drop the database, recreate it, and the load a set of test data into it. This is ideal if you don't have a complex system with lots of test data. </li> <li>The second way is to try and <strong>compensate</strong> for the current state and move your test system from whatever state it is in, to the necessary state. This is a suitable approach if recreating the system is time-consuming, or if you need to use an existing system. The trade off is that the type of scripts you'll need to write might be time-consuming in themselves.</li> </ul> <p>Let's consider this example. You want a test to make sure a user who has been disabled cannot login. You should not create this user in another test, because you'll be coupling your tests together (mean that many tests could fail but there may only be a single problem test), or it's simply not possible to disable users in your application.</p> <p>If you're using initialisation strategy, at the start of the test run:</p> <ol> <li>Insert a test user named "disableduser" with a password "testpassword" into the database.</li> <li>Mark them as disabled.</li> </ol> <p>If you're using the compensation strategy, you would:</p> <ol> <li>Find out if your user already exists.</li> <li>If they don't create them as before.</li> <li>If they do, make sure their password is set to "testpassword".</li> <li>Check to see if they have any differences to a newly register user that might affect your test, and correct them.</li> <li>Mark them as disabled.</li> </ol> <p>Or you could:</p> <ol> <li>Find an unused username.</li> <li>Insert a test user with that username with a password "testpassword" into the database.</li> <li>Mark them as disabled.</li> <li>Store that username somewhere the test can reference it from.</li> </ol> <p>You can see from this example that the compensation strategy has some problems. In the first option you'll could easily end up with a user that might not be able to login for some other reason. In the second you'll rapidly end up with far more users than you need for your tests, slowing your test system up.</p> <p>Another important consideration is the design of your build, is that you should not rely on your tests to set themselves up.</p> <p> </p> <p>TODO</p> <h2 id=summary>Summary</h2> <p> </p> <p>TODO</p> <div id=disqus_thread></div> <script>
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'alexecollins'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script> <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript> </div> <div class=col-md-3 id=sidebar> <center> <h2>Alex Collins</h2> <p> <a href="/"><img src="/images/alex-collins-circle.png"/></a> </p> </center> <p> Java technical lead and solutions architect in London for the UK IT industry for over ten years. <a href="/about-me">more...</a> </p> <h4>Docker Maven Plugin</h4> <p>Version 2.11.4 released, <a href="https://github.com/alexec/docker-maven-plugin/blob/master/CHANGELOG.md">more...</a></p> <pre style="font-size:50%">&lt;dependency&gt;
  &lt;groupId&gt;com.alexecollins.docker&lt;/groupId&gt;
  &lt;artifactId&gt;docker-maven-plugin&lt;/artifactId&gt;
  &lt;version&gt;2.11.4&lt;/version&gt;
&lt;/dependency&gt;</pre> <h4>Related</h4> <ol> <li><a href="/taking-a-screeshot-with-selenium-web-driver/">Taking a Screeshot with Selenium Web Driver</a></li> <li><a href="/polyglot-maven-first-steps/">Polyglot Maven First Steps</a></li> <li><a href="/selenium-visual-testing/">Visual Testing With Selenium WebDriver</a></li> <li><a href="/elastic-search-in-a-box-with-docker/">Search In A Box With Docker, Elastic Search, Spring Boot, and Selenium</a></li> <li><a href="/migrating-to-circleci/">Migrating to CircleCI</a></li> </ol> <h4>Recent</h4> <ul> <li><a href="/developing-with-docker-proxy-container-pattern/">Developing With Docker - Using The Proxy Container Pattern To Make Development Easier</a> <span>Nov 28</span></li> <li><a href="/practical-domain-specific-language-tutorial/">Practical Java Domain Specific Language Tutorial</a> <span>Sep 19</span></li> <li><a href="/sonarqube-and-java-8/">Sonarqube And Java 8</a> <span>Sep 17</span></li> <li><a href="/spring-boot-performance/">Spring Boot Performance</a> <span>Sep 5</span></li> <li><a href="/testing-anti-patterns/">Testing Anti-Patterns</a> <span>Jun 23</span></li> </ul> <h4>Tags</h4> <a href="/tags/ci/">ci</a> (3)</a>&nbsp;&nbsp; <a href="/tags/concurrency/">concurrency</a> (4)</a>&nbsp;&nbsp; <a href="/tags/docker/">docker</a> (11)</a>&nbsp;&nbsp; <a href="/tags/gist/">gist</a> (13)</a>&nbsp;&nbsp; <a href="/tags/groovy/">groovy</a> (4)</a>&nbsp;&nbsp; <a href="/tags/java/">java</a> (48)</a>&nbsp;&nbsp; <a href="/tags/jmeter/">jmeter</a> (3)</a>&nbsp;&nbsp; <a href="/tags/junit/">junit</a> (7)</a>&nbsp;&nbsp; <a href="/tags/links/">links</a> (14)</a>&nbsp;&nbsp; <a href="/tags/maven/">maven</a> (18)</a>&nbsp;&nbsp; <a href="/tags/oped/">oped</a> (8)</a>&nbsp;&nbsp; <a href="/tags/performance/">performance</a> (6)</a>&nbsp;&nbsp; <a href="/tags/plaf/">plaf</a> (14)</a>&nbsp;&nbsp; <a href="/tags/ruby/">ruby</a> (3)</a>&nbsp;&nbsp; <a href="/tags/selenium/">selenium</a> (9)</a>&nbsp;&nbsp; <a href="/tags/software/">software</a> (10)</a>&nbsp;&nbsp; <a href="/tags/spring/">spring</a> (7)</a>&nbsp;&nbsp; <a href="/tags/swing/">swing</a> (15)</a>&nbsp;&nbsp; <a href="/tags/testing/">testing</a> (23)</a>&nbsp;&nbsp; <a href="/tags/tips/">tips</a> (4)</a>&nbsp;&nbsp; <a href="/tags/tomcat/">tomcat</a> (3)</a>&nbsp;&nbsp; <a href="/tags/unix/">unix</a> (6)</a>&nbsp;&nbsp; <a href="/tags/web/">web</a> (4)</a>&nbsp;&nbsp; </hr/> <p> <a class="btn btn-primary btn-xs" href="/sitemap">Sitemap</a> <a class="btn btn-primary btn-xs" href="/feed.xml">RSS</a> <a class="btn btn-primary btn-xs" href="//uk.linkedin.com/in/alexecollins">LinkedIn</a> </p> </div> </div> <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-25388993-1', 'auto');
  ga('require', 'linkid', 'linkid.js');
  ga('send', 'pageview');

</script> </body> </html>